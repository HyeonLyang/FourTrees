<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itbank.model.SearchDAO">

<!-- 	<select id="searchAll" resultType="com.itbank.model.vo.RestaurantVO"> -->
<!--     		SELECT * FROM restaurant -->
<!-- 				WHERE -->
<!-- 				<if test="address != null and address != ''"> -->
<!-- 					address LIKE '%' || #{address} || '%' -->
<!-- 				</if> -->
<!-- 				<if test="category != null and category != ''"> -->
<!-- 					<if test="address != null and address != ''"> AND </if> -->
<!-- 					category LIKE '%' || #{category} || '%' -->
<!-- 				</if> -->
<!-- 	</select> -->
	
<!-- 	<select id="searchHeader" resultType="com.itbank.model.vo.RestaurantVO"> -->
<!-- 	    SELECT * FROM restaurant -->
<!-- 	    WHERE -->
<!-- 	    검색어(search)가 주소(address) 또는 카테고리(category)에 포함되는 경우 -->
<!-- 	    <if test="search != null and search != ''"> -->
<!-- 	        주소 또는 카테고리 중 하나라도 포함되는 경우 -->
<!-- 	        <if test="search != null and search != ''"> -->
<!-- 	            address LIKE '%' || #{search} || '%' -->
<!-- 	        </if> -->
	
<!-- 	        <if test="search != null and search != ''"> -->
<!-- 	            <if test="search != null and search != ''"> OR </if> -->
<!-- 	            category LIKE '%' || #{search} || '%' -->
<!-- 	        </if> -->
<!-- 	    </if> -->
<!-- 	</select> -->
	
	<select id="selectAll"
			resultType="com.itbank.model.vo.RestaurantVO"
			parameterType="com.itbank.components.Paging">
		select * from restaurant 
				WHERE
				<if test="address != null and address != ''">
					address LIKE '%' || #{address} || '%'
				</if>
				<if test="category != null and category != ''">
						<if test="address != null and address != ''"> 
						AND 
						</if>
					category LIKE '%' || #{category} || '%'
				</if>
			order by idx desc 
			offset #{offset} rows 
			fetch first #{perCount} rows only		
	</select>
	
	<select id="getTotalSearch"
			resultType="int">
		select count(*) from restaurant where 
				<if test="address != null and address != ''">
					address LIKE '%' || #{address} || '%'
				</if>
				<if test="category != null and category != ''">
						<if test="address != null and address != ''"> 
						AND 
						</if>
					category LIKE '%' || #{category} || '%'
				</if>
	</select>
	
</mapper>